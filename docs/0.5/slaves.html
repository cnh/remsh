<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Slaves &mdash; remsh v0.5 documentation</title>
    <link rel="stylesheet" href="static/default.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.5',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <link rel="top" title="remsh v0.5 documentation" href="index.html" />
    <link rel="up" title="Using Remsh" href="using_remsh.html" />
    <link rel="next" title="Developer Documentation" href="developer.html" />
    <link rel="prev" title="Slave Collections" href="slave_collections.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="developer.html" title="Developer Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="slave_collections.html" title="Slave Collections"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">remsh v0.5 documentation</a> &raquo;</li>
          <li><a href="using_remsh.html" accesskey="U">Using Remsh</a> &raquo;</li> 
      </ul>
    </div>  
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  
  <div class="section" id="id1">
<span id="slaves"></span><h1>Slaves<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>Slaves, in the context of the master, represent a remote system ready to
perform operations on behalf of the master.  The <cite>Slave</cite> class is designed
to be easily subclassed by users, but only one implementation is included
with <cite>remsh</cite>.</p>
<dl class="class">
<dt id="remsh.master.slave.Slave">
<!--[remsh.master.slave.Slave]-->class <tt class="descclassname">remsh.master.slave.</tt><tt class="descname">Slave</tt><big>(</big><em>conn</em>, <em>hostname</em>, <em>version</em><big>)</big><a class="headerlink" href="#remsh.master.slave.Slave" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>conn</em> &#8211; <tt class="xref docutils literal"><span class="pre">Connection</span></tt> this slave should use</li>
<li><em>hostname</em> &#8211; hostname of the slave</li>
<li><em>version</em> &#8211; protocol version the slave supplied</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Slave objects give access to all of the operations supported by remsh.
Note that these operations all block, first waiting for any already-running
operations to finish, and then waiting for the requested operation to
finish.  To support concurrent use of multiple slaves, invoke operations
from different Python threads on the master.</p>
<p>Any of the &#8220;operation&#8221; methods may raise
<a title="remsh.amp.rpc.RemoteError" class="reference" href="developer/rpc.html#remsh.amp.rpc.RemoteError"><tt class="xref docutils literal"><span class="pre">RemoteError</span></tt></a>, <a title="remsh.amp.wire.Error" class="reference" href="developer/amp.html#remsh.amp.wire.Error"><tt class="xref docutils literal"><span class="pre">Error</span></tt></a>, or
<tt class="xref docutils literal"><span class="pre">socket.error</span></tt>.</p>
<dl class="method">
<dt id="remsh.master.slave.Slave.set_cwd">
<!--[remsh.master.slave.Slave.set_cwd]--><tt class="descname">set_cwd</tt><big>(</big><em>cwd=None</em><big>)</big><a class="headerlink" href="#remsh.master.slave.Slave.set_cwd" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>cwd</em> &#8211; directory to switch to, or None for basedir</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Sets the working directory of the slave, returning the new working
directory.  Raises an <a title="remsh.amp.rpc.RemoteError" class="reference" href="developer/rpc.html#remsh.amp.rpc.RemoteError"><tt class="xref docutils literal"><span class="pre">RemoteError</span></tt></a> if the
designated directory is not found.  The pathname is treated as a simple
bytestring, to be interepreted by the slave.</p>
<p>If <cite>cwd</cite> is None, then this method resets the working directory to the
slave&#8217;s base directory.  Note that such an invocation may still raise
<a title="remsh.amp.rpc.RemoteError" class="reference" href="developer/rpc.html#remsh.amp.rpc.RemoteError"><tt class="xref docutils literal"><span class="pre">RemoteError</span></tt></a>, if the slave&#8217;s base directory has
been deleted.</p>
<p>if <cite>cwd</cite> is an empty string, then no directory change takes place, and
the method returns the current directory.</p>
</dd></dl>

<dl class="method">
<dt id="remsh.master.slave.Slave.mkdir">
<!--[remsh.master.slave.Slave.mkdir]--><tt class="descname">mkdir</tt><big>(</big><em>dir</em><big>)</big><a class="headerlink" href="#remsh.master.slave.Slave.mkdir" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>dir</em> &#8211; directory to create (relative or absolute)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Does the equivalent of <tt class="docutils literal"><span class="pre">mkdir</span> <span class="pre">-p</span></tt> on the remote system.  Raises an
<a title="remsh.amp.rpc.RemoteError" class="reference" href="developer/rpc.html#remsh.amp.rpc.RemoteError"><tt class="xref docutils literal"><span class="pre">RemoteError</span></tt></a> in the event of an error on the
slave side.  It is <em>not</em> an error to create a directory that already
exists.</p>
</dd></dl>

<dl class="method">
<dt id="remsh.master.slave.Slave.unlink">
<!--[remsh.master.slave.Slave.unlink]--><tt class="descname">unlink</tt><big>(</big><em>file</em><big>)</big><a class="headerlink" href="#remsh.master.slave.Slave.unlink" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>file</em> &#8211; the file to unlink</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Deletes the given file, raising a <a title="remsh.amp.rpc.RemoteError" class="reference" href="developer/rpc.html#remsh.amp.rpc.RemoteError"><tt class="xref docutils literal"><span class="pre">RemoteError</span></tt></a>
in the event of an error.  It is an error to delete a file that does
not exist.</p>
</dd></dl>

<dl class="method">
<dt id="remsh.master.slave.Slave.execute">
<!--[remsh.master.slave.Slave.execute]--><tt class="descname">execute</tt><big>(</big><em>args=</em><span class="optional">[</span><span class="optional">]</span>, <em>stdout_cb=None</em>, <em>stderr_cb=None</em><big>)</big><a class="headerlink" href="#remsh.master.slave.Slave.execute" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><em>args</em> &#8211; sequence of command-line arguments</li>
<li><em>stdout_cb</em> &#8211; callback for stdout data</li>
<li><em>stderr_cb</em> &#8211; callback for stderr data</li>
</ul>
</td>
</tr>
<tr class="field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">process exit code (0 generally meaning success)</p>
</td>
</tr>
</tbody>
</table>
<p>Execute <cite>args</cite> in a subprocess.</p>
<p>If <cite>stdout_cb</cite> is not None, it is called for each &#8220;chunk&#8221; of the
executable&#8217;s standard output seen; <cite>stderr_cb</cite> does the same for
standard error.</p>
</dd></dl>

<p>The Slave class also implements a few utility methods:</p>
<dl class="method">
<dt id="remsh.master.slave.Slave.setup">
<!--[remsh.master.slave.Slave.setup]--><tt class="descname">setup</tt><big>(</big><big>)</big><a class="headerlink" href="#remsh.master.slave.Slave.setup" title="Permalink to this definition">¶</a></dt>
<dd>This method is a hook, called after the slave has registered, but
before it is added to the slave collection. The method is called in its
own thread, and can do whatever additional setup is required, including
executing operations on the slave.  One possibility is to dynamically
investigate the capabilities of the slave for later use.  Another is to
set up periodic commands, e.g. keepalives or load monitoring.  These
should run in a separate thread.</dd></dl>

<dl class="method">
<dt id="remsh.master.slave.Slave.on_disconnect">
<!--[remsh.master.slave.Slave.on_disconnect]--><tt class="descname">on_disconnect</tt><big>(</big><em>callable</em><big>)</big><a class="headerlink" href="#remsh.master.slave.Slave.on_disconnect" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><em>callable</em> &#8211; invoked when the slave disconnects</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Register <cite>callable</cite> to be called when this slave disconnects,
whether smoothly or in the midst of an operation.  Slave collection
objects (see <a class="reference" href="slave_collections.html#slave-collections"><em>Slave Collections</em></a>) should use this to mark the
slave as no longer available.  The callable is invoked with the
<tt class="xref docutils literal"><span class="pre">Slave</span></tt> instance as its argument.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="slave_collections.html" title="previous chapter">Slave Collections</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="developer.html" title="next chapter">Developer Documentation</a></p>
          <h3>Quick search</h3>
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="developer.html" title="Developer Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="slave_collections.html" title="Slave Collections"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">remsh v0.5 documentation</a> &raquo;</li>
          <li><a href="using_remsh.html" accesskey="U">Using Remsh</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2009-2009, Dustin J. Mitchell &lt;dustin@zmanda.com&gt;.
      Last updated on Jul 05, 2009.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.5.2.
    </div>
  </body>
</html>